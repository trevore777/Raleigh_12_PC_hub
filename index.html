<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Raleigh 12 PC Hub ‚Äì Interactive</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --primary: #1e3a8a;
      --primary-light: #3b82f6;
      --bg: #0f172a;
      --card-bg: #111827;
      --accent: #facc15;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #ef4444;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1d4ed8 0, #020617 55%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 1rem;
    }

    .app { width: 100%; max-width: 1100px; margin: auto; }

    header { text-align: center; margin-bottom: 1.5rem; }

    header h1 { font-size: 1.9rem; font-weight: 700; margin-bottom: 0.25rem; }

    header p { font-size: 0.9rem; color: var(--text-muted); }

    .day-chip {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.8rem;
      margin-top: 0.4rem;
    }

    .layout {
      display: grid;
      gap: 1rem;
    }

    @media (min-width: 880px) {
      .layout {
        grid-template-columns: 3fr 2.2fr;
        align-items: start;
      }
    }

    .grid {
      display: grid;
      gap: 1rem;
    }

    @media (min-width: 720px) {
      .grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .card {
      background: rgba(15, 23, 42, 0.92);
      border-radius: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.85);
      padding: 1rem 1.1rem 1.1rem;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .badge {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
    }

    .card-body {
      font-size: 0.9rem;
      line-height: 1.45;
      color: var(--text-main);
      white-space: pre-line;
    }

    .card-body p + p { margin-top: 0.4rem; }

    .hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 0.5rem 0.9rem;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: white;
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.45);
      transition: transform 0.08s ease, box-shadow 0.08s ease, opacity 0.08s ease;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.6);
    }

    .outline-btn {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.7);
      box-shadow: none;
      color: var(--text-main);
    }

    button:disabled {
      opacity: 0.65;
      cursor: wait;
      box-shadow: none;
    }

    .small-caps {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .music-frame {
      border-radius: 0.75rem;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.4);
      margin-top: 0.4rem;
    }

    iframe { width: 100%; border: 0; }

    .footer-note {
      text-align: center;
      margin-top: 1.3rem;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .footer-note span { color: var(--accent); }

    .ai-output {
      margin-top: 0.4rem;
      padding: 0.55rem 0.6rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: rgba(15, 23, 42, 0.85);
      min-height: 60px;
      font-size: 0.9rem;
      line-height: 1.4;
      overflow-y: auto;
      max-height: 260px;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.25rem;
    }

    .pill {
      font-size: 0.72rem;
      padding: 0.1rem 0.45rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text-muted);
    }

    .api-key-warning {
      font-size: 0.75rem;
      color: var(--danger);
      margin-top: 0.3rem;
    }

    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.4rem;
      margin-top: 0.25rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .toggle-row label {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      cursor: pointer;
    }

    input[type="checkbox"] {
      width: 15px;
      height: 15px;
      accent-color: var(--primary-light);
      cursor: pointer;
    }

    .api-key-input {
      width: 100%;
      margin-top: 0.4rem;
      padding: 0.4rem 0.5rem;
      border-radius: 0.6rem;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.78rem;
    }

    .api-key-input::placeholder {
      color: rgba(148, 163, 184, 0.8);
    }
  </style>

  <!-- OurManna Verse of the Day -->
  <script src="https://beta.ourmanna.com/verses/api/js/" type="text/javascript" defer></script>
</head>
<body>
  <div class="app">
    <header>
      <h1>Raleigh 12 PC Hub</h1>
      <p>Pastoral Care ¬∑ Monday / Wednesday / Thursday / Friday ¬∑ ~10 minutes</p>
      <div class="day-chip">
        <span id="today-label">Today</span>
      </div>
    </header>

    <div class="layout">
      <!-- LEFT: Normal PC flow -->
      <div>
        <div class="grid">
          <!-- Opening Prayer -->
          <section class="card">
            <div class="card-header">
              <div class="card-title">üôè Opening Prayer</div>
              <span class="badge">Step 1</span>
            </div>
            <div class="card-body" id="prayer-text">
              Heavenly Father, thank You for this new day and for Raleigh 12.
              Help us to honour You in our thoughts, words and actions today.
              Give us wisdom in our decisions, kindness in our friendships,
              and courage to do what is right.

              Be with us in this PC time. Calm our hearts, clear our minds,
              and help us to grow together as a class. In Jesus‚Äô name, Amen.
            </div>
            <p class="hint">Use this, or tap ‚ÄúGenerate Prayer‚Äù on the right to create one for today's theme.</p>
          </section>

          <!-- Verse of the Day -->
          <section class="card">
            <div class="card-header">
              <div class="card-title">üìñ Verse & Reflection</div>
              <span class="badge">Step 2</span>
            </div>
            <div class="card-body">
              <div id="ourmanna-verse">Loading verse of the day‚Ä¶</div>
              <p class="hint" id="verse-hint">
                <strong>Discussion prompt:</strong> In one sentence, how could we live this verse out at school today?
              </p>
            </div>
            <button type="button" class="outline-btn" onclick="nextVersePrompt()">
              üîÑ New discussion prompt
            </button>
          </section>

          <!-- Positive Thought -->
          <section class="card">
            <div class="card-header">
              <div class="card-title">üåü Positive Thought</div>
              <span class="badge">Step 3</span>
            </div>
            <div class="card-body">
              <p id="positive-text">
                Today is a fresh start. Yesterday‚Äôs mistakes are learning moments, not labels.
                You have the chance to choose courage, kindness, and faith again today.
              </p>
              <p class="hint">Read it aloud, then ask: ‚ÄúWhat word or phrase stands out to you?‚Äù</p>
            </div>
            <button type="button" onclick="newPositiveThought()">
              üîÅ New positive thought
            </button>
          </section>

          <!-- Music + Game -->
          <section class="card">
            <div class="card-header">
              <div class="card-title">üéµ Music & Game of the Day</div>
              <span class="badge">Step 4</span>
            </div>
            <div class="card-body">
              <p class="small-caps">Background Music</p>
              <p>Hit play on a worship / Christian lo-fi playlist while students get settled.</p>

              <!-- Replace with your own playlist ID -->
              <div class="music-frame">
                <iframe
                  src="https://www.youtube.com/embed/videoseries?list=YOUR_PLAYLIST_ID_HERE"
                  title="PC Background Playlist"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen
                ></iframe>
              </div>

              <p class="small-caps" style="margin-top:0.7rem;">Community Game of the Day</p>
              <p id="game-text">
                Stand Up If‚Ä¶  
                Ask students to stand if statements apply to them (e.g. ‚ÄúYou have a pet‚Äù,
                ‚ÄúYou like pineapple on pizza‚Äù, ‚ÄúYou prefer beaches to mountains‚Äù).
                Quick, fun, and shows what you have in common.
              </p>
              <p class="hint">Tap below for another quick game idea, or use the AI assistant to generate one.</p>
            </div>
            <button type="button" onclick="newGame()">üé≤ New game idea</button>
          </section>
        </div>
      </div>

      <!-- RIGHT: AI-powered PC assistant -->
      <aside class="card">
        <div class="card-header">
          <div class="card-title">
            ü§ñ AI PC Assistant
          </div>
          <span class="badge">Teacher tools</span>
        </div>

        <div class="card-body">
          <p class="small-caps">API Key</p>
          <input
            type="password"
            id="api-key"
            class="api-key-input"
            placeholder="Paste your OpenAI API key here (kept only in this browser tab)"
          />
          <p class="api-key-warning">
            For production, move the key to a backend route. This is okay as a teacher-only prototype.
          </p>

          <div class="toggle-row">
            <label>
              <input type="checkbox" id="short-mode" checked />
              Prefer short, PC-length answers
            </label>
          </div>

          <div class="pill-row">
            <div class="pill">Year level: 12</div>
            <div class="pill">Christian school</div>
            <div class="pill">10-minute PC</div>
            <div class="pill">Raleigh 12</div>
          </div>

          <hr style="border: none; border-top: 1px solid rgba(148,163,184,0.4); margin:0.6rem 0;" />

          <p class="small-caps">Generate</p>
          <div style="display:flex; flex-wrap:wrap; gap:0.35rem; margin-top:0.35rem;">
            <button type="button" class="outline-btn" id="btn-prayer" onclick="generateFromAI('prayer')">
              üïä Prayer
            </button>
            <button type="button" class="outline-btn" id="btn-devotional" onclick="generateFromAI('devotional')">
              üìñ Devotional thought
            </button>
            <button type="button" class="outline-btn" id="btn-questions" onclick="generateFromAI('questions')">
              üí¨ Discussion questions
            </button>
            <button type="button" class="outline-btn" id="btn-game" onclick="generateFromAI('game')">
              üé≤ Community game
            </button>
          </div>

          <div class="ai-output" id="ai-output">
            AI output will appear here. Use it live with the class or copy into Compass.
          </div>

          <p class="hint">
            Tip: you can still use the fixed content on the left, then use the AI panel when you want
            something tailored to that day (e.g. ‚Äústress before exams‚Äù, ‚Äúfriendship issues‚Äù, etc.).
          </p>
        </div>
      </aside>
    </div>

    <p class="footer-note">
      <span>Verse of the Day</span> provided by OurManna Bible API.  
      AI content powered by OpenAI (configured for Christian, age-appropriate PC use).
    </p>
  </div>

  <script>
    // ---------- Day label ----------
    const dayNames = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
    const pcDays = ["Monday","Wednesday","Thursday","Friday"];

    function updateTodayLabel() {
      const now = new Date();
      const dayName = dayNames[now.getDay()];
      const label = document.getElementById("today-label");
      if (pcDays.includes(dayName)) {
        label.textContent = dayName + " ¬∑ PC today";
      } else {
        label.textContent = dayName + " ¬∑ No scheduled PC (optional)";
      }
    }

    // ---------- Verse discussion prompts ----------
    const versePrompts = [
      "What word or phrase in this verse stands out to you the most? Why?",
      "How could this verse shape the way we treat each other in Raleigh 12 today?",
      "If you lived this verse fully for one school day, what would change?",
      "What does this verse show you about God‚Äôs character?",
      "Is there a simple, practical action you could take today because of this verse?"
    ];

    function nextVersePrompt() {
      const hint = document.getElementById("verse-hint");
      const random = versePrompts[Math.floor(Math.random() * versePrompts.length)];
      hint.innerHTML = "<strong>Discussion prompt:</strong> " + random;
    }

    // ---------- Positive thoughts ----------
    const positiveThoughts = [
      "You are not here by accident. God has placed you in this PC, in this school, in this year for a reason.",
      "Small consistent choices ‚Äî saying sorry, including someone, telling the truth ‚Äî shape the person you become.",
      "Even on tough days, you are loved by God and valued by the people around you more than you realise.",
      "You don‚Äôt have to be perfect today. You just have to be willing to learn, grow, and try again.",
      "Kindness is never wasted. Someone in our school needs the kindness you can show today."
    ];

    function newPositiveThought() {
      const el = document.getElementById("positive-text");
      const random = positiveThoughts[Math.floor(Math.random() * positiveThoughts.length)];
      el.textContent = random;
    }

    // ---------- Community games ----------
    const games = [
      "Two Truths and a Dream: Students share two true facts about themselves and one thing they‚Äôd like to do or achieve. The group guesses which is the dream.",
      "This or That: Quickly go around the room with choices (Beach or mountains? Pizza or burgers? Morning or night?). Students move to a side of the room or raise hands.",
      "Common Ground: In small groups, students have 2 minutes to find three things they all have in common that aren‚Äôt obvious (not uniforms or school).",
      "High/Low/Thankful: Each student shares a high from the week, a low, and one thing they‚Äôre thankful for.",
      "Silent Line-Up: Without talking, students line up in order of birthday (day/month), height, or alphabetical by first name.",
      "Would You Rather ‚Äì Values Edition: Ask fun but thoughtful questions (e.g. 'Would you rather have everyone be honest with you or always be kind to you? Why?')."
    ];

    function newGame() {
      const el = document.getElementById("game-text");
      const random = games[Math.floor(Math.random() * games.length)];
      el.textContent = random;
    }

    // ---------- AI calls ----------
    async function generateFromAI(type) {
      const apiKey = document.getElementById("api-key").value.trim();
      const shortMode = document.getElementById("short-mode").checked;
      const outputEl = document.getElementById("ai-output");

      if (!apiKey) {
        outputEl.textContent = "Please paste your OpenAI API key first.";
        return;
      }

      // Disable buttons during call
      const buttons = [
        "btn-prayer",
        "btn-devotional",
        "btn-questions",
        "btn-game"
      ].map(id => document.getElementById(id));
      buttons.forEach(btn => btn.disabled = true);
      outputEl.textContent = "Thinking‚Ä¶ (generating " + type + ")";

      // Grab verse text if available to feed into context
      let verseText = "";
      const verseEl = document.getElementById("ourmanna-verse");
      if (verseEl) {
        verseText = verseEl.innerText || verseEl.textContent || "";
      }

      // Build the prompt
      let userInstruction = "";
      switch (type) {
        case "prayer":
          userInstruction =
            "Write a short opening prayer for a Year 12 pastoral care class (Raleigh 12) in a Christian school. " +
            "Be warm, simple and age-appropriate. Mention school life and friendships. Keep it suitable to be read aloud by a teacher in under 45 seconds.";
          break;
        case "devotional":
          userInstruction =
            "Write a short devotional thought for a Year 12 pastoral care group based on the Bible text below. " +
            "1‚Äì2 short paragraphs, clear and practical, focused on how students might live this out at school today. " +
            "Finish with one simple reflection question.\n\nBible text:\n" + verseText;
          break;
        case "questions":
          userInstruction =
            "Create 4‚Äì6 short discussion questions for a Year 12 pastoral care group in a Christian school. " +
            "Questions should be simple, open-ended, and safe for a mixed class. Aim to help them reflect on faith, character, and school life. " +
            "Number the questions 1‚Äì6.";
          break;
        case "game":
          userInstruction =
            "Suggest one quick, low-prep community-building game for a Year 12 pastoral care class (approx 5 minutes). " +
            "The game must be classroom-safe, require no special equipment, and be inclusive of quieter students. " +
            "Explain the steps clearly in bullet points.";
          break;
        default:
          userInstruction = "Provide a short, encouraging Christian thought for a Year 12 pastoral care class.";
      }

      if (shortMode) {
        userInstruction += "\n\nKeep the response concise enough to read in under 2 minutes.";
      }

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + apiKey
          },
          body: JSON.stringify({
            model: "gpt-4o-mini",
            messages: [
              {
                role: "system",
                content:
                  "You are a Christian teacher assistant helping run a 10-minute pastoral care (PC) session " +
                  "for a Year 12 class in an Australian Christian school. Keep everything age-appropriate, " +
                  "kind, and aligned with a general evangelical Christian worldview. Avoid controversial topics. " +
                  "Write in clear, spoken English that a teacher can read aloud."
              },
              {
                role: "user",
                content: userInstruction
              }
            ],
            temperature: 0.7,
            max_tokens: 450
          })
        });

        if (!response.ok) {
          const errorText = await response.text();
          outputEl.textContent = "Error from OpenAI: " + errorText;
        } else {
          const data = await response.json();
          const text = data.choices?.[0]?.message?.content?.trim() || "No response text.";
          outputEl.textContent = text;
        }
      } catch (err) {
        console.error(err);
        outputEl.textContent = "Network or API error: " + err.message;
      } finally {
        buttons.forEach(btn => btn.disabled = false);
      }
    }

    // ---------- Init ----------
    document.addEventListener("DOMContentLoaded", () => {
      updateTodayLabel();
      newPositiveThought();
      newGame();
    });
  </script>
</body>
</html>
